services:
  backend:
    image: ${REGISTRY}/lems-backend:${IMAGE_TAG}
    ports:
      - '3333:3333'
    networks:
      - lems-network
    restart: always
    environment:
      # Database configuration
      - DB_NAME=${DB_NAME}
      - MONGODB_URI=${MONGODB_URI}
      - PG_HOST=${PG_HOST}
      - PG_PORT=${PG_PORT}
      - PG_USER=${PG_USER}
      - PG_PASSWORD=${PG_PASSWORD}
      # Authentication & Security
      - JWT_SECRET=${JWT_SECRET}
      - DASHBOARD_JWT_SECRET=${DASHBOARD_JWT_SECRET}
      - SCHEDULER_JWT_SECRET=${SCHEDULER_JWT_SECRET}
      - RECAPTCHA=${RECAPTCHA}
      - RECAPTCHA_SECRET_KEY=${RECAPTCHA_SECRET_KEY}
      # External Services
      - LEMS_DOMAIN=${LEMS_DOMAIN}
      - SCHEDULER_URL=${SCHEDULER_URL}
      # Cloud Storage (DigitalOcean Spaces)
      - DIGITALOCEAN_ENDPOINT=${DIGITALOCEAN_ENDPOINT}
      - DIGITALOCEAN_SPACE=${DIGITALOCEAN_SPACE}
      - DIGITALOCEAN_KEY=${DIGITALOCEAN_KEY}
      - DIGITALOCEAN_SECRET=${DIGITALOCEAN_SECRET}

networks:
  lems-network:
    driver: bridge
