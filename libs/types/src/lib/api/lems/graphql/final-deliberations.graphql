"""
Final deliberation for selecting division awards
"""
type FinalDeliberation {
  "The division ID this deliberation is for"
  divisionId: String!

  "Current stage of the deliberation (not-started, champions, core-awards, optional-awards, review)"
  stage: String!

  "Current status (not-started, in-progress, completed)"
  status: String!

  "Timestamp when the deliberation was started (ISO 8601)"
  startTime: String

  "Timestamp when the deliberation was completed (ISO 8601)"
  completionTime: String

  "Champions placement - Record<place number, team ID> as JSON"
  champions: JSON!

  "Innovation Project award winners (ordered list of team IDs)"
  innovationProject: [String!]!

  "Robot Design award winners (ordered list of team IDs)"
  robotDesign: [String!]!

  "Core Values award winners (ordered list of team IDs)"
  coreValues: [String!]!

  "Robot Performance award winners (ordered list of team IDs)"
  robotPerformance: [String!]!

  "Optional awards - dynamic based on division's award configuration with automatic_assignment=true. Key is award name, value is ordered list of team IDs. Returned as JSON."
  optionalAwards: JSON!

  "Manual eligibility for core awards stage"
  coreAwardsManualEligibility: [String!]!

  "Manual eligibility for optional awards stage"
  optionalAwardsManualEligibility: [String!]!
}

extend type Judging {
  "Get the final deliberation for this division"
  finalDeliberation: FinalDeliberation
}

type FinalDeliberationStartResult {
  status: String!
  stage: String!
  startTime: String!
}

type FinalDeliberationStageResult {
  stage: String!
  status: String!
}

type FinalDeliberationAwardsResult {
  awards: String!
}

type ManualEligibilityResult {
  stage: String!
  manualEligibility: [String!]!
}

type FinalDeliberationCompleteResult {
  status: String!
  completionTime: String!
}

type FinalDeliberationUpdatedEvent {
  divisionId: String!
  status: String
  stage: String
  startTime: String
  completionTime: String
  awards: String
  stageData: String
}

type FinalDeliberationStatusChangedEvent {
  divisionId: String!
  status: String!
  stage: String!
}

extend type Mutation {
  """
  Start the final deliberation for a division
  """
  startFinalDeliberation(divisionId: String!): FinalDeliberationStartResult!

  """
  Advance to the next stage in the final deliberation
  """
  advanceFinalDeliberationStage(divisionId: String!): FinalDeliberationStageResult!

  """
  Update award assignments in the final deliberation
  """
  updateFinalDeliberationAwards(
    divisionId: String!
    awards: String!
  ): FinalDeliberationAwardsResult!

  """
  Update manual eligibility for a specific stage
  """
  updateManualEligibility(
    divisionId: String!
    stage: String!
    teamIds: [String!]!
  ): ManualEligibilityResult!

  """
  Complete and lock the final deliberation
  """
  completeFinalDeliberation(divisionId: String!): FinalDeliberationCompleteResult!
}

extend type Subscription {
  """
  Subscribe to updates for the final deliberation
  """
  finalDeliberationUpdated(divisionId: String!): FinalDeliberationUpdatedEvent!

  """
  Subscribe to status changes for the final deliberation
  """
  finalDeliberationStatusChanged(divisionId: String!): FinalDeliberationStatusChangedEvent!
}
