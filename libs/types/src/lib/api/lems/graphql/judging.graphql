"""
A judging session where a team is evaluated by judges
"""
type JudgingSession {
  "Unique identifier for the judging session"
  id: String!

  "Session number within the division"
  number: Int!

  "Scheduled start time (ISO 8601 datetime)"
  scheduledTime: String!

  "Current status of the session (e.g., 'not-started', 'in-progress', 'completed')"
  status: String!

  "Whether the team for this session has been called to the judging room"
  called: Boolean!

  "Room where this session is taking place"
  room: Room!

  "Team being judged in this session"
  team: Team

  "Actual timestamp when the session was started"
  startTime: String

  "Difference in seconds between scheduled and actual start time"
  startDelta: Int

  "Rubrics for this session categorized by judging category"
  rubrics: CategorizedRubrics!
}

"""
Judging-related information for a division
"""
type Judging {
  "ID of the division this judging data belongs to"
  divisionId: String!

  "Judging sessions in this division, optionally filtered"
  sessions(
    "Filter sessions by their IDs"
    ids: [String!]

    "Filter session by team IDs"
    teamIds: [String!]

    "Filter sessions by room ID"
    roomId: String

    "Filter sessions scheduled before this time (ISO 8601)"
    scheduledBefore: String

    "Filter sessions scheduled after this time (ISO 8601)"
    scheduledAfter: String
  ): [JudgingSession!]!

  "Room IDs available for judging in this division"
  rooms: [String!]!

  "Length of each judging session in seconds"
  sessionLength: Int!

  "Rubrics for teams in this division, optionally filtered"
  rubrics(
    "Filter rubrics by team IDs"
    teamIds: [String!]

    "Filter rubrics by judging category"
    category: JudgingCategory
  ): [Rubric!]!

  "Awards available for this division"
  awards("Whether teams can be nominated for awards" allowNominations: Boolean): [Award!]!

  "Advancement percentage for teams in this division, null if advancement is disabled"
  advancementPercentage: Int
}

extend type Division {
  "Judging information and sessions for this division"
  judging: Judging!
}

extend type Query {
  """
  Get judging information for a specific division
  """
  judging("Division ID to retrieve judging information for" divisionId: String!): Judging
}

"""
Represents an event when a judging session has started
"""
type JudgingStartedEvent {
  "Judging session identifier"
  sessionId: String!

  "Actual timestamp when the session was started"
  startTime: String!

  "Difference in seconds between scheduled and actual start time"
  startDelta: Int!
}

"""
Represents an event when a judging session has changed state
"""
type JudgingSessionEvent {
  "Judging session identifier"
  sessionId: String!
}

extend type Mutation {
  """
  Start a judging session.
  """
  startJudgingSession(
    "The ID of the division containing the session"
    divisionId: String!
    "The ID of the session to start"
    sessionId: String!
  ): JudgingStartedEvent!

  """
  Abort a judging session.
  """
  abortJudgingSession(
    "The ID of the division containing the session"
    divisionId: String!
    "The ID of the session to abort"
    sessionId: String!
  ): JudgingSessionEvent!
}

extend type Subscription {
  """
  Subscribe to events when judging sessions start in a division.
  """
  judgingSessionStarted(
    "The division ID to listen for updates in"
    divisionId: String!
  ): JudgingStartedEvent!

  """
  Subscribe to events when judging sessions abort in a division.
  """
  judgingSessionAborted(
    "The division ID to listen for updates in"
    divisionId: String!
  ): JudgingSessionEvent!

  """
  Subscribe to events when judging sessions complete in a division.
  """
  judgingSessionCompleted(
    "The division ID to listen for updates in"
    divisionId: String!
  ): JudgingSessionEvent!
}
